<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>관리자 페이지- 1:1 문의 </title>
<style>
#titles{
  width        : 800px;     /* 너비는 변경될수 있습니다. */
  text-overflow: ellipsis;  /* 위에 설정한 100px 보다 길면 말줄임표처럼 표시합니다. */
  white-space  : nowrap;    /* 줄바꿈을 하지 않습니다. */
  overflow     : hidden;    /* 내용이 길면 감춤니다 */
  display      : block       /* ie6이상 현재요소를 블럭처리합니다. */
}
</style>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

<script src="https://code.jquery.com/jquery-3.6.1.min.js" 
	integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" 
		crossorigin="anonymous"></script>
<script> 

function search_board()
{

   var serData = $('#search_board').serialize();
   
   $.ajax({
      url: '/admin/search_qna',
      method: 'post',
      data: serData,
      dataType: 'json',   
      cache: false,     
      success: function(res){

       	var cnt = res.length;
         for(var i=0; i<cnt; i++)
         {
      	   $('#found tbody').html( '<tr>'
      	   							+ '<td>'+res[i].qnum+'</td>'
      	   							+'<td>'+
      	   								'<a href = "/admin/detail_q/'+ res[i].qnum + '">'  + res[i].title + '</a>'
      	   							+'</td>'
      	   							+'<td>'+res[i].author+'</td>'
      	   							+'<td>'+res[i].hit+'</td>'
      	   							+'<td>'+res[i].qdate+'</td>'
      	   							+ '</tr>'
      	   )            	   
         
         }
      }, 
      error: function(xhr,status,err){
         alert('에러'+err);
      }
   })

   return false;
}
	

</script>      			
</head>
<body>
<div>
    <div th:replace="fragments/managernav :: header"></div>
</div>
<div class="container">
	<h3 style="color:grey; text-align:center;"> 고객 관리</h3> 
	<h5 style="text-align:center;">1:1 문의</h5>
	
	<div style="float:left">
	<a class="btn btn-secondary" href="/admin/add">관리자 글쓰기</a>
	</div>

	<form id="search_board" onsubmit='return search_board();'>
	<div style= "float: right"> 
		<input type="text" id='input' name='input' placeholder='제목을 입력하세요'> 
		<button type="submit">검색</button>
	</div>
	</form>
	
	<table class="table table-hover" id="found">
		<thead>
		<tr>
			<th>번호</th>
			<th>제목</th>
			<th>작성자</th>
			<th>조회수</th>
			<th>등록일</th>
		</tr>
		</thead>
		<tbody>
		<tr th:each="board: ${pageOneboard}">
		    <td> [[${board.qnum}]] </td>
			<td>
				<div id="titles">
					<a th:href= "|/admin/detailByQnum/${board.qnum}|" style="text-decoration:none">	
					[[${board.title}]]
					</a>
				</div>
			</td>
			<td>[[${board.author}]]</td>
			<td>[[${board.hit}]]</td>
			<td>[[${board.qdate}]]</td>	
			
		</tr>
		</tbody>
	</table>
</div>
<div id="pagination" style=" margin-left:150px; padding-top:20px; text-align: center; width: 80%;" >
	<span th:if="${pageOneboard.getNumber() gt 9}"><a
		th:href="@{/admin/qaList(page=${pageOneboard.getNumber()/10*10-1})}">이전</a></span>

	<th:block th:if="${i le pageOneboard.getTotalPages()}" th:each="i : ${#numbers.sequence(pageOneboard.getNumber()/10*10+1 , pageOneboard.getNumber()/10*10+10)}">
		<a th:href="@{/admin/qaList(page=${i-1})}"> [[${i}]]</span>
	</th:block>
	
	<span th:if="${(pageOneboard.getNumber()/10*10+10)<pageOneboard.getTotalPages()}">
		<a th:href="@{/admin/qaList(page=${pageOneboard.getNumber()/10*10+10})}">다음</a>
	</span>
	
	
</div>
</body>
</html>